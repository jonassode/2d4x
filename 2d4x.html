<html>
	<head>
		<script type='text/javascript' src='https://raw.github.com/jonassode/javascript-matrix/master/releases/jsmatrix_001.js' ></script>
		<script type='text/javascript' src='https://raw.github.com/jonassode/javascript-lineofsight/master/releases/jslos_003.js' ></script>
		<script type='text/javascript' src='nodes.js' ></script> 
		<script type='text/javascript' src='2d4x.js' ></script> 
		<script type='text/javascript' src='player.js' ></script> 
		<script type='text/javascript' src='draw.js' ></script> 
		<script type='text/javascript' src='generate.js' ></script> 

	</head>
	<body>
		<font face="Monospace">
		<table style="border:2px silver solid;">
			<tr>
				<td colspan="2">
					<div id="map_area" >&nbsp;</div>
				</td>
			</tr>
			<tr>
				<td width="50%" valign="top">
					<b>Tile information</b><br>
					<div id="tile_area" >&nbsp;</div>
				</td>
				<td width="50%" valign="top">
					<div id="unit_area" >&nbsp;</div>

				</td>
			</tr>
			<tr>
				<td width="50%" valign="top">
					<b>Player list:</b></br>
					<div id="player_area" >&nbsp;</div>
				</td>
				<td width="50%" valign="top">
					<button onclick='end_turn();'>End Turn</button>&nbsp;
					<button onclick='FOW ? FOW = false:FOW = true; draw.screen();'>Fog of War</button>&nbsp;<br>
					<div id="log_area" >&nbsp;</div>
				</td>
			</tr>
		</table>

		<script>

		// Stolen from Snipplier
		// POSTED BY the_coder on 09/16/09
		// http://snipplr.com/view/19838/get-url-parameters/
		function getUrlVars() {
		    var vars = {};
		    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
			vars[key] = value;
		    });
		    return vars;
		}
		var vars = getUrlVars();

		function getIntOrDefault(name, default_value){
			return vars[name] != undefined ? parseInt( vars[name] ) : default_value;
		}


		function getBooleanOrDefault(name, default_value){
			return vars[name] != undefined ? Boolean( vars[name] ) : default_value;
		}

		var width = getIntOrDefault("width", 50);
		var height = getIntOrDefault("height", 20);
		var start_level = getIntOrDefault("start", 5);
		var water_level = getIntOrDefault("water", 4);

		generate.set_start_level(start_level);
		generate.set_water_level(water_level);

	 	var world = generate.world(height, width);
		var LOG = "";
		var FOW = getBooleanOrDefault("FOW", true);

		player.add('mr player 0');
		player.add('mr player 1');

		player.get(0).add_unit(world, nodes.settler(), start_level-1, 0);
		player.get(1).add_unit(world, nodes.settler(), start_level-1, width-1);

		draw.screen();

		</script>
	</body>
<html>

